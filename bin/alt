#!/usr/bin/env ruby
# encoding: UTF-8

$:.unshift(File.expand_path("../../lib", __FILE__))

require "pp"
require "alt"
require "readline"

stty_save = `stty -g`.chomp
trap("INT") { system "stty", stty_save; exit }

interpreter = Alt::Interpreter.new

if file = ARGV.first
  interpreter.eval(File.read(file))
else
  puts "alt #{Alt::VERSION}"
  while line = Readline::readline(">> ", true)
    begin
      val = interpreter.eval(line)
      pp val if val
    rescue Alt::RuntimeError => e
      puts "ERROR: #{e}"
    end
  end
end